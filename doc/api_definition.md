# API定義書

## プロジェクト名

AI Friend - 愛嬌とユーモアのあるパーソナルAI

## 1. 会話API

### 1.1 エンドポイント

`/chat`

### 1.2 メソッド

POST

### 1.3 リクエスト

* **ヘッダー:**
    * `Content-Type`: `application/json`
* **ボディ:**
```json
{
  "user_id": "ユーザーID",
  "message": "ユーザーの発話内容"
}
```

### 1.4 レスポンス

* **ステータスコード:** 200 OK
* **ボディ:**
```json
{
  "response": "AIフレンドの応答"
}
```

## 2. 感情認識API

### 2.1 エンドポイント

`/analyze_emotion`

### 2.2 メソッド

POST

### 2.3 リクエスト

* **ヘッダー:**
    * `Content-Type`: `audio/wav` またはその他の音声フォーマット
* **ボディ:**
    * 音声データ (バイナリ)

### 2.4 レスポンス

* **ステータスコード:** 200 OK
* **ボディ:**
```json
{
  "emotion": "認識された感情 (喜び, 悲しみ, 怒り, 恐れ, 平常)"
}
```

## 3. 認証

APIの認証方式について記述する。例：APIキー、OAuth 2.0など。
今回のプロジェクトでは、ユーザー認証にメールアドレスとパスワード、Googleログインを想定しているため、それぞれの認証フローについても記述する。

### 3.1 メールアドレスとパスワード認証

1. ユーザーはメールアドレスとパスワードでログインを試みる。
2. サーバーは提供されたクレデンシャルをデータベースと照合する。
3. 認証が成功した場合、サーバーはアクセストークンを生成し、クライアントに返す。
4. クライアントは、以降のAPIリクエストでアクセストークンをヘッダーに含める。

### 3.2 Googleログイン

1. ユーザーはGoogleアカウントでログインを試みる。
2. クライアントはGoogleの認証フローを通じてIDトークンを取得する。
3. クライアントはIDトークンをサーバーに送信する。
4. サーバーはIDトークンを検証し、ユーザーを認証する。
5. 認証が成功した場合、サーバーはアクセストークンを生成し、クライアントに返す。
6. クライアントは、以降のAPIリクエストでアクセストークンをヘッダーに含める。

## 4. エラーハンドリング

APIのエラーレスポンスの形式について記述する。

```json
{
  "error": {
    "code": "エラーコード",
    "message": "エラーメッセージ"
  }
}
