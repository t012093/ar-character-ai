# 詳細設計書

## プロジェクト名

AI Friend - 愛嬌とユーモアのあるパーソナルAI

## 1. システムアーキテクチャ

システムの全体構成を示す。

## 2. 各機能の詳細設計

### 2.1 会話機能

* **モジュール:** 会話管理モジュール
* **処理フロー:**
    1. ユーザーの発話を音声認識API（Azure Cognitive Services for Speech または OpenAI Whisper）でテキストに変換する。
    2. 変換されたテキストをOpenAI API (GPTモデル) に送信し、応答を生成する。
    3. 生成された応答をテキストから音声に変換し、ユーザーに提示する。
    4. 会話履歴をデータベースに保存する。
* **データ:** 会話履歴データ

### 2.2 感情認識機能

* **モジュール:** 感情認識モジュール
* **処理フロー:**
    1. ユーザーの発話音声を分析し、声質、トーン、内容から感情を抽出する。
    2. 抽出された感情に基づいて、会話管理モジュールに応答の調整を指示する。
* **データ:** 感情分析モデル

### 2.3 共感機能

* **モジュール:** 共感応答モジュール
* **処理フロー:**
    1. 会話内容と感情認識結果を基に、共感的な応答を生成する。
    2. 適切な相槌や質問を生成し、会話の流れを円滑にする。
* **データ:** 共感表現パターン

### 2.4 愛嬌とユーモア

* **モジュール:** キャラクター表現モジュール
* **処理フロー:**
    1. 会話の流れや文脈に応じて、冗談やユーモアのある応答を生成する。
    2. 個性的な口癖や話し方を適用する。
* **データ:** キャラクター設定データ、ユーモア表現パターン

### 2.5 AR表示機能

* **モジュール:** AR表示モジュール
* **処理フロー:**
    1. Unityで作成されたAIフレンドの3Dモデルをロードする。
    2. ARCore/ARKitを用いて、現実空間を認識し、AIフレンドを配置する。
    3. ユーザーの操作に応じて、AIフレンドの移動やアニメーションを制御する。
* **データ:** AIフレンド3Dモデル、アニメーションデータ

### 2.6 データベース設計

* **テーブル:**
    * `users`: ユーザー情報 (user_id, email, password, google_id)
    * `conversations`: 会話履歴 (conversation_id, user_id, timestamp)
    * `messages`: メッセージ内容 (message_id, conversation_id, sender, content, timestamp)

## 3. API設計

### 3.1 会話API

* **エンドポイント:** `/chat`
* **メソッド:** POST
* **リクエスト:** `{ "user_id": "string", "message": "string" }`
* **レスポンス:** `{ "response": "string" }`

### 3.2 感情認識API

* **エンドポイント:** `/analyze_emotion`
* **メソッド:** POST
* **リクエスト:** `{ "audio": "binary" }`
* **レスポンス:** `{ "emotion": "string" }`

## 4. モジュール構成

各機能を実現するためのモジュール構成を示す。

## 5. データフロー

システム内でのデータの流れを示す。
